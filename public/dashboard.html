<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>AI Options Strategy Builder â€¢ Dashboard</title>

  <!-- Bootstrap / Icons / Chart.js -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1"></script>

  <style>
    :root{
      /* light theme */
      --bg: #f6f7fb;
      --surface: #ffffff;
      --text: #1b2230;
      --muted: #6b7380;
      --primary: #2563eb;
      --primary-600:#1d4ed8;
      --accent:#9b59b6;
      --success:#16a34a;
      --danger:#e11d48;
      --warn:#f59e0b;
      --ring: 0 0 0 .25rem rgba(37,99,235,.2);
      --shadow: 0 6px 20px rgba(27,34,48,.08);
      --card-blur: saturate(1.1) blur(0px);
      --kpi-bg: #f0f4ff;
    }
    [data-theme="dark"]{
      --bg:#0f1724;
      --surface:#121b2d;
      --text:#e5e9f3;
      --muted:#94a3b8;
      --primary:#60a5fa;
      --primary-600:#3b82f6;
      --accent:#c084fc;
      --success:#22c55e;
      --danger:#fb7185;
      --warn:#fbbf24;
      --ring: 0 0 0 .25rem rgba(96,165,250,.25);
      --shadow: 0 8px 28px rgba(2,6,23,.45);
      --card-blur:saturate(1.2) blur(2px);
      --kpi-bg:#0b1220;
    }

    html,body{height:100%}
    body{background:var(--bg); color:var(--text); font-family: Inter,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";}

    /* App header */
    .app-hero{
      position:relative;
      overflow:hidden;
      background: radial-gradient(1200px 600px at 20% -10%, rgba(37,99,235,.25), transparent 55%),
                  radial-gradient(900px 500px at 90% -10%, rgba(155,89,182,.18), transparent 55%),
                  linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,0));
      border-bottom:1px solid rgba(99,102,241,.12);
    }
    .brand{
      display:flex;gap:.6rem;align-items:center;font-weight:700;letter-spacing:.2px
    }
    .brand .logo{
      width:36px;height:36px;border-radius:10px;background:
      radial-gradient(18px 18px at 70% 30%, rgba(96,165,250,.9), transparent 60%),
      linear-gradient(135deg, var(--primary), var(--accent));
      box-shadow:0 8px 24px rgba(37,99,235,.35);
    }
    .chip{font-size:.75rem;border-radius:999px;padding:.2rem .6rem;border:1px solid rgba(148,163,184,.25); color:var(--muted);}

    /* Cards */
    .card{
      border:0;background:color-mix(in srgb, var(--surface) 86%, transparent);
      backdrop-filter: var(--card-blur);
      border-radius:16px; box-shadow: var(--shadow);
    }
    .card-title{font-weight:700; letter-spacing:.2px}
    .card-header{border:0;background:transparent;padding:1rem 1.25rem}
    .card-body{padding:1.25rem}

    /* KPI */
    .kpi{
      background:var(--kpi-bg);
      border:1px solid color-mix(in srgb, var(--primary) 15%, transparent);
      border-radius:14px; padding:1rem 1.1rem
    }
    .kpi .label{color:var(--muted);font-size:.8rem}
    .kpi .value{font-weight:800;font-size:1.35rem}
    .kpi .delta.up{color:var(--success)} .kpi .delta.down{color:var(--danger)}

    /* Buttons */
    .btn-primary{background:var(--primary);border-color:var(--primary)}
    .btn-primary:hover{background:var(--primary-600);border-color:var(--primary-600)}
    .btn-ai{background:var(--accent);color:#fff}
    .btn-ai:hover{filter:brightness(.95)}
    .btn-outline-light{--bs-btn-color:#fff; --bs-btn-border-color:rgba(255,255,255,.5); --bs-btn-hover-bg:rgba(255,255,255,.12)}

    /* Table */
    .table thead th{font-size:.8rem; color:var(--muted); text-transform:uppercase; letter-spacing:.06em;border-bottom:1px solid rgba(148,163,184,.25)}
    .option-table .call{background:rgba(16,185,129,.08)}
    .option-table .put{background:rgba(239,68,68,.08)}
    .option-table tbody tr:hover{background: color-mix(in srgb, var(--primary) 7%, transparent)}

    /* Sticky subnav */
    .subnav{position:sticky;top:-1px;z-index:100;background:var(--bg);border-bottom:1px solid rgba(148,163,184,.15)}
    .nav-tabs .nav-link{border:0;color:var(--muted);font-weight:600}
    .nav-tabs .nav-link.active{color:var(--text); background:none; border-bottom:3px solid var(--primary); border-radius:0}

    /* Misc */
    .market-status{display:inline-flex;align-items:center;gap:.5rem;padding:.35rem .7rem;border-radius:999px;background:rgba(16,185,129,.12);color:var(--success);font-weight:700}
    .market-status.closed{background:rgba(239,68,68,.12);color:var(--danger)}
    .ring:focus{box-shadow:var(--ring)!important}
    .skeleton{height:10px;border-radius:6px;background:linear-gradient(90deg, rgba(148,163,184,.2), rgba(148,163,184,.35), rgba(148,163,184,.2));background-size:200% 100%;animation:load 1.2s infinite}
    @keyframes load{0%{background-position:200% 0}100%{background-position:-200% 0}}
  </style>
</head>
<body>

  <!-- Top hero -->
  <header class="app-hero py-4">
    <div class="container d-flex flex-wrap gap-3 align-items-center justify-content-between">
      <div class="d-flex align-items-center gap-3">
        <div class="logo"></div>
        <div>
          <div class="brand fs-4">AI Options Strategy Builder</div>
          <div class="d-flex gap-2 mt-1">
            <span class="chip"><i class="bi bi-database me-1"></i> Dhan v2</span>
            <span class="chip"><i class="bi bi-cloud-check me-1"></i> Sandbox</span>
          </div>
        </div>
      </div>
      <div class="d-flex align-items-center gap-2">
        <span class="market-status" id="mktState"><i class="bi bi-circle-fill"></i> Market Open</span>
        <button class="btn btn-outline-light btn-sm" id="themeBtn" title="Toggle theme"><i class="bi bi-moon-stars"></i></button>
        <button class="btn btn-outline-light btn-sm"><i class="bi bi-question-circle"></i></button>
      </div>
    </div>
  </header>

  <!-- Sub nav -->
  <div class="subnav">
    <div class="container">
      <ul class="nav nav-tabs" id="tabs" role="tablist">
        <li class="nav-item" role="presentation">
          <button class="nav-link active" data-bs-toggle="tab" data-bs-target="#tab-home" type="button">Dashboard</button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" data-bs-toggle="tab" data-bs-target="#tab-strategy" type="button">Strategy Builder</button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" data-bs-toggle="tab" data-bs-target="#tab-expiry" type="button">Expiry Analysis</button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" data-bs-toggle="tab" data-bs-target="#tab-ai" type="button">AI Recommendations</button>
        </li>
      </ul>
    </div>
  </div>

  <main class="container py-4">
    <div class="tab-content">

      <!-- ============ DASHBOARD ============ -->
      <section class="tab-pane fade show active" id="tab-home">
        <div class="row g-4">
          <!-- Controls -->
          <div class="col-lg-8">
            <div class="card">
              <div class="card-header d-flex justify-content-between align-items-center">
                <h6 class="card-title mb-0">Controls</h6>
                <div class="d-flex gap-2">
                  <button class="btn btn-sm btn-primary ring" id="fetchBtn"><i class="bi bi-lightning-charge me-1"></i>Fetch Option Chain</button>
                  <button class="btn btn-sm btn-outline-secondary ring" id="resetBtn"><i class="bi bi-arrow-counterclockwise"></i></button>
                </div>
              </div>
              <div class="card-body">
                <div class="row g-3">
                  <div class="col-md-4">
                    <label class="form-label small">Symbol</label>
                    <select class="form-select ring" id="symbolSel">
                      <option>NIFTY</option><option selected>BANKNIFTY</option>
                      <option>RELIANCE</option><option>TATASTEEL</option>
                    </select>
                  </div>
                  <div class="col-md-4">
                    <label class="form-label small">Expiry</label>
                    <select class="form-select ring" id="expSel">
                      <option>2025-08-28</option>
                      <option>2025-09-04</option>
                      <option>2025-09-11</option>
                    </select>
                  </div>
                  <div class="col-md-4">
                    <label class="form-label small">Segment</label>
                    <select class="form-select ring" id="segSel">
                      <option>NSE_INDEX</option>
                      <option>NSE_FNO</option>
                    </select>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Status -->
          <div class="col-lg-4">
            <div class="card mb-4">
              <div class="card-header"><h6 class="card-title mb-0">Broker Status</h6></div>
              <div class="card-body d-flex align-items-center justify-content-between">
                <div class="d-flex align-items-center gap-2">
                  <i class="bi bi-check-circle-fill text-success fs-5"></i>
                  <div>
                    <div class="fw-semibold">Connected</div>
                    <small class="text-secondary">Token & Client present</small>
                  </div>
                </div>
                <span class="badge text-bg-primary-subtle border border-primary">Sandbox</span>
              </div>
            </div>
            <div class="card">
              <div class="card-header"><h6 class="card-title mb-0">Market Overview</h6></div>
              <div class="card-body">
                <div class="d-flex justify-content-between">
                  <div><small class="text-secondary">NIFTY 50</small><div class="fw-bold">19,425 <span class="text-success">+1.2%</span></div></div>
                  <div><small class="text-secondary">BANKNIFTY</small><div class="fw-bold">43,827 <span class="text-success">+1.5%</span></div></div>
                </div>
              </div>
            </div>
          </div>

          <!-- KPI Row -->
          <div class="col-12">
            <div class="row g-3">
              <div class="col-6 col-md-3"><div class="kpi"><div class="label">Spot Price</div><div class="value" id="kpiSpot">â‚¹43,826</div></div></div>
              <div class="col-6 col-md-3"><div class="kpi"><div class="label">OI Change</div><div class="value">+5.2% <span class="delta up ms-1"><i class="bi bi-arrow-up-right"></i></span></div></div></div>
              <div class="col-6 col-md-3"><div class="kpi"><div class="label">Put/Call Ratio</div><div class="value" id="kpiPCR">0.82</div></div></div>
              <div class="col-6 col-md-3"><div class="kpi"><div class="label">Avg. IV</div><div class="value">18.5%</div></div></div>
            </div>
          </div>

          <!-- Charts -->
          <div class="col-lg-6">
            <div class="card h-100">
              <div class="card-header d-flex justify-content-between align-items-center">
                <h6 class="card-title mb-0">Open Interest</h6>
                <span class="badge text-bg-light"><i class="bi bi-columns-gap me-1"></i>Calls vs Puts</span>
              </div>
              <div class="card-body"><canvas id="oiChart" height="260"></canvas></div>
            </div>
          </div>
          <div class="col-lg-6">
            <div class="card h-100">
              <div class="card-header d-flex justify-content-between align-items-center">
                <h6 class="card-title mb-0">Volume</h6>
                <span class="badge text-bg-light"><i class="bi bi-activity me-1"></i>Per strike</span>
              </div>
              <div class="card-body"><canvas id="volChart" height="260"></canvas></div>
            </div>
          </div>

          <!-- Option Chain Table -->
          <div class="col-12">
            <div class="card">
              <div class="card-header d-flex justify-content-between align-items-center">
                <h6 class="card-title mb-0">Option Chain â€¢ BANKNIFTY <span class="text-secondary fw-normal">(26 Oct 2023)</span></h6>
                <div class="form-check form-switch">
                  <input class="form-check-input ring" type="checkbox" id="autoRef" checked>
                  <label class="form-check-label small" for="autoRef">Auto refresh (30s)</label>
                </div>
              </div>
              <div class="card-body">
                <div class="table-responsive">
                  <table class="table align-middle option-table" id="chainTbl">
                    <thead>
                      <tr>
                        <th colspan="6" class="text-center">CALLS</th>
                        <th class="text-center">Strike</th>
                        <th colspan="6" class="text-center">PUTS</th>
                      </tr>
                      <tr>
                        <th>OI</th><th>Î” OI</th><th>Vol</th><th>IV</th><th>LTP</th><th>Chg</th>
                        <th></th>
                        <th>Chg</th><th>LTP</th><th>IV</th><th>Vol</th><th>Î” OI</th><th>OI</th>
                      </tr>
                    </thead>
                    <tbody>
                      <!-- sample rows -->
                      <tr>
                        <td class="call">12,345</td><td class="call">+1,234</td><td class="call">4,567</td><td class="call">16.8%</td><td class="call">â‚¹125.50</td><td class="call text-success">+5.25</td>
                        <td class="text-center fw-semibold">43,500</td>
                        <td class="put text-danger">-3.75</td><td class="put">â‚¹84.25</td><td class="put">18.2%</td><td class="put">3,456</td><td class="put">-567</td><td class="put">9,876</td>
                      </tr>
                      <tr class="table-active">
                        <td class="call">9,876</td><td class="call">+1,987</td><td class="call">6,789</td><td class="call">17.8%</td><td class="call">â‚¹76.25</td><td class="call text-success">+3.75</td>
                        <td class="text-center fw-semibold">43,700</td>
                        <td class="put text-danger">-1.50</td><td class="put">â‚¹105.75</td><td class="put">17.5%</td><td class="put">5,432</td><td class="put">-345</td><td class="put">7,654</td>
                      </tr>
                    </tbody>
                  </table>
                </div>
                <div class="text-secondary small mt-2">Tip: sort by any column using your browserâ€™s table helpers or export from the Strategy tab.</div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- ============ STRATEGY BUILDER ============ -->
      <section class="tab-pane fade" id="tab-strategy">
        <div class="row g-4">
          <div class="col-lg-8">
            <div class="card">
              <div class="card-header d-flex justify-content-between align-items-center">
                <h6 class="card-title mb-0">AI Strategy Builder</h6>
                <button class="btn btn-sm btn-ai"><i class="bi bi-robot me-1"></i>Generate</button>
              </div>
              <div class="card-body">
                <div class="row g-3 mb-2">
                  <div class="col-md-6">
                    <label class="form-label small">Market Outlook</label>
                    <select class="form-select ring">
                      <option>Bullish</option><option>Slightly Bullish</option>
                      <option selected>Neutral</option><option>Slightly Bearish</option><option>Bearish</option>
                    </select>
                  </div>
                  <div class="col-md-6">
                    <label class="form-label small">Risk Level</label>
                    <select class="form-select ring">
                      <option>Low</option><option selected>Moderate</option><option>High</option>
                    </select>
                  </div>
                  <div class="col-md-6">
                    <label class="form-label small">Capital (â‚¹)</label>
                    <input type="number" class="form-control ring" value="50000">
                  </div>
                  <div class="col-md-6">
                    <label class="form-label small">Expiry Preference</label>
                    <select class="form-select ring"><option>Weekly</option><option selected>Monthly</option><option>Quarterly</option></select>
                  </div>
                </div>

                <div class="p-3 border rounded-3" style="border-style:dashed">
                  <h6 class="mb-2">Recommended: Iron Condor</h6>
                  <p class="text-secondary small mb-3">Neutral bias, benefits from time decay and vol contraction.</p>
                  <div class="row g-4">
                    <div class="col-md-6">
                      <h6 class="text-secondary small text-uppercase">Positions</h6>
                      <ul class="mb-0">
                        <li>Sell CALL 44,200 @ â‚¹120.50</li>
                        <li>Buy CALL 44,400 @ â‚¹85.25</li>
                        <li>Sell PUT 43,400 @ â‚¹95.75</li>
                        <li>Buy PUT 43,200 @ â‚¹70.50</li>
                      </ul>
                    </div>
                    <div class="col-md-6">
                      <h6 class="text-secondary small text-uppercase">Key Metrics</h6>
                      <ul class="mb-0">
                        <li>Max Profit: <span class="text-success">â‚¹6,200</span></li>
                        <li>Max Loss: <span class="text-danger">â‚¹3,800</span></li>
                        <li>Breakeven: 43,540 â€“ 44,060</li>
                        <li>Probability of Profit: 68%</li>
                      </ul>
                    </div>
                  </div>
                  <div class="mt-3 p-3 rounded-3" style="background:rgba(155,89,182,.12); border-left:3px solid var(--accent)">
                    <strong><i class="bi bi-lightbulb"></i> AI Insight:</strong>
                    IV Rank ~65% â†’ favors short-vol. Monitor 43,200â€“44,400 range.
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Payoff + Stats -->
          <div class="col-lg-4">
            <div class="card mb-4">
              <div class="card-header"><h6 class="card-title mb-0">Strategy Payoff</h6></div>
              <div class="card-body"><canvas id="payoffChart" height="260"></canvas></div>
            </div>

            <div class="card">
              <div class="card-header"><h6 class="card-title mb-0">Statistics</h6></div>
              <div class="card-body">
                <div class="mb-3">
                  <label class="form-label small">Probability of Profit</label>
                  <div class="progress" style="height:10px">
                    <div class="progress-bar bg-success" style="width:68%">68%</div>
                  </div>
                </div>
                <div class="mb-3 d-flex justify-content-between">
                  <span>Risk/Reward</span><span class="text-success">1 : 1.63</span>
                </div>
                <div class="mb-3 d-flex justify-content-between">
                  <span>Theta (daily)</span><span class="text-success">â‚¹420</span>
                </div>
                <div class="d-flex justify-content-between">
                  <span>IV Rank</span><span class="text-warning">65% (High)</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- ============ EXPIRY ============ -->
      <section class="tab-pane fade" id="tab-expiry">
        <div class="row g-4">
          <div class="col-lg-8">
            <div class="card">
              <div class="card-header d-flex justify-content-between align-items-center">
                <h6 class="card-title mb-0">Expiry Analysis</h6>
                <div class="btn-group btn-group-sm">
                  <button class="btn btn-outline-primary">Weekly</button>
                  <button class="btn btn-primary">Monthly</button>
                  <button class="btn btn-outline-primary">Quarterly</button>
                </div>
              </div>
              <div class="card-body">
                <div class="row g-4">
                  <div class="col-md-6">
                    <div class="border rounded-3 p-3">
                      <div class="d-flex justify-content-between"><strong>Max Pain</strong><span>43,800</span></div>
                      <div class="d-flex justify-content-between"><span>Highest Call OI</span><span>44,000 (82,345)</span></div>
                      <div class="d-flex justify-content-between"><span>PCR</span><span id="expPCR">0.82</span></div>
                      <div class="mt-3"><canvas id="callOiChart" height="200"></canvas></div>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="border rounded-3 p-3">
                      <div class="d-flex justify-content-between"><strong>Support</strong><span>43,500</span></div>
                      <div class="d-flex justify-content-between"><span>Highest Put OI</span><span>43,500 (67,890)</span></div>
                      <div class="d-flex justify-content-between"><span>IV Skew</span><span>+2.5%</span></div>
                      <div class="mt-3"><canvas id="putOiChart" height="200"></canvas></div>
                    </div>
                  </div>
                </div>

                <div class="mt-4 p-3 rounded-3" style="background:rgba(99,102,241,.1); border-left:3px solid var(--primary)">
                  <strong><i class="bi bi-lightbulb"></i> Expiry Day Strategy:</strong>
                  If IV &gt; 40% and max pain stable at 43,800, consider 43,800 straddles with wings.
                </div>
              </div>
            </div>
          </div>

          <div class="col-lg-4">
            <div class="card mb-4">
              <div class="card-header"><h6 class="card-title mb-0">Time Decay</h6></div>
              <div class="card-body"><canvas id="thetaChart" height="220"></canvas><small class="text-secondary">Theta accelerates in last week.</small></div>
            </div>
            <div class="card">
              <div class="card-header"><h6 class="card-title mb-0">IV Curve</h6></div>
              <div class="card-body"><canvas id="ivTermChart" height="220"></canvas><small class="text-secondary">Event risk can steepen near expiry.</small></div>
            </div>
          </div>
        </div>
      </section>

      <!-- ============ AI RECS ============ -->
      <section class="tab-pane fade" id="tab-ai">
        <div class="row g-4">
          <div class="col-lg-8">
            <div class="card border-start border-3" style="border-color:var(--accent)!important">
              <div class="card-header"><h6 class="card-title mb-0">AI Trading Recommendations</h6></div>
              <div class="card-body">
                <div class="row g-4">
                  <div class="col-md-6">
                    <div class="card h-100">
                      <div class="card-header">Top Bullish</div>
                      <div class="card-body">
                        <h6>Bull Call Spread</h6>
                        <p class="mb-2">Buy 43,800 CE @ â‚¹220.50<br>Sell 44,200 CE @ â‚¹125.75</p>
                        <div class="d-flex justify-content-between"><span>Max Profit</span><span class="text-success">â‚¹9,500</span></div>
                        <div class="d-flex justify-content-between"><span>Max Loss</span><span class="text-danger">â‚¹4,500</span></div>
                        <div class="d-flex justify-content-between mb-2"><span>Probability</span><span>62%</span></div>
                        <button class="btn btn-sm btn-primary w-100">Execute</button>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="card h-100">
                      <div class="card-header">Top Neutral</div>
                      <div class="card-body">
                        <h6>Iron Butterfly</h6>
                        <p class="mb-2">Sell 43,800 CE @ â‚¹120.50<br>Sell 43,800 PE @ â‚¹110.25<br>Buy wings 100 points away</p>
                        <div class="d-flex justify-content-between"><span>Max Profit</span><span class="text-success">â‚¹7,200</span></div>
                        <div class="d-flex justify-content-between"><span>Max Loss</span><span class="text-danger">â‚¹12,800</span></div>
                        <div class="d-flex justify-content-between mb-2"><span>Probability</span><span>65%</span></div>
                        <button class="btn btn-sm btn-primary w-100">Execute</button>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="row g-4 mt-1">
                  <div class="col-md-6">
                    <div class="card h-100">
                      <div class="card-header">Top Bearish</div>
                      <div class="card-body">
                        <h6>Bear Put Spread</h6>
                        <p class="mb-2">Buy 43,800 PE @ â‚¹180.25<br>Sell 43,400 PE @ â‚¹125.50</p>
                        <div class="d-flex justify-content-between"><span>Max Profit</span><span class="text-success">â‚¹10,900</span></div>
                        <div class="d-flex justify-content-between"><span>Max Loss</span><span class="text-danger">â‚¹5,100</span></div>
                        <div class="d-flex justify-content-between mb-2"><span>Probability</span><span>58%</span></div>
                        <button class="btn btn-sm btn-primary w-100">Execute</button>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="card h-100">
                      <div class="card-header">AI Outlook</div>
                      <div class="card-body">
                        <h6>Neutral â†’ Slightly Bullish</h6>
                        <div class="mb-2">
                          <span class="me-2">Signal Strength</span>
                          <div class="progress" style="height:10px"><div class="progress-bar" style="width:65%"></div></div>
                        </div>
                        <p class="mb-2">Based on options flow + technical regime. Watch 43,500 / 44,200.</p>
                        <div class="p-2 rounded-3" style="background:rgba(155,89,182,.12)"><i class="bi bi-lightbulb"></i> <b>Key Levels:</b> Support 43,500 â€¢ Resistance 44,200</div>
                      </div>
                    </div>
                  </div>
                </div>

              </div>
            </div>
          </div>

          <div class="col-lg-4">
            <div class="card mb-4">
              <div class="card-header"><h6 class="card-title mb-0">AI Confidence</h6></div>
              <div class="card-body">
                <div class="mb-3">
                  <div class="d-flex justify-content-between small"><span>Data Quality</span><span>92%</span></div>
                  <div class="progress" style="height:10px"><div class="progress-bar bg-success" style="width:92%"></div></div>
                </div>
                <div class="mb-3">
                  <div class="d-flex justify-content-between small"><span>Pattern Accuracy</span><span>87%</span></div>
                  <div class="progress" style="height:10px"><div class="progress-bar bg-info" style="width:87%"></div></div>
                </div>
                <div class="mb-3">
                  <div class="d-flex justify-content-between small"><span>Strategy Win Prob</span><span>76%</span></div>
                  <div class="progress" style="height:10px"><div class="progress-bar bg-primary" style="width:76%"></div></div>
                </div>
                <div class="">
                  <div class="d-flex justify-content-between small"><span>Regime Detection</span><span>83%</span></div>
                  <div class="progress" style="height:10px"><div class="progress-bar bg-warning" style="width:83%"></div></div>
                </div>
              </div>
            </div>

            <div class="card">
              <div class="card-header"><h6 class="card-title mb-0">Historical Performance</h6></div>
              <div class="card-body"><canvas id="perfChart" height="220"></canvas><small class="text-secondary">AI strategies beat benchmark by 14.2% (6m).</small></div>
            </div>
          </div>
        </div>
      </section>

    </div>
  </main>

  <!-- Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    // Theme toggle
    const themeBtn = document.getElementById('themeBtn');
    themeBtn.addEventListener('click', ()=>{
      const html = document.documentElement;
      html.dataset.theme = (html.dataset.theme === 'dark') ? 'light' : 'dark';
      themeBtn.innerHTML = html.dataset.theme === 'dark' ? '<i class="bi bi-brightness-high"></i>' : '<i class="bi bi-moon-stars"></i>';
    });

    // Mock KPIs auto update
    setInterval(()=>{
      document.getElementById('kpiSpot').textContent = 'â‚¹43,'+(800+Math.floor(Math.random()*80));
      document.getElementById('kpiPCR').textContent = (0.7 + Math.random()*0.3).toFixed(2);
    }, 5000);

    // Charts (sample data)
    const oiCtx = document.getElementById('oiChart');
    const volCtx = document.getElementById('volChart');
    const payoffCtx = document.getElementById('payoffChart');
    const callOiCtx = document.getElementById('callOiChart');
    const putOiCtx = document.getElementById('putOiChart');
    const thetaCtx = document.getElementById('thetaChart');
    const ivTermCtx = document.getElementById('ivTermChart');
    const perfCtx = document.getElementById('perfChart');

    const labels = ['43,500','43,600','43,700','43,800','43,900'];

    new Chart(oiCtx,{type:'bar',data:{labels,datasets:[
      {label:'Call OI',data:[12345,10987,9876,8765,7654]},
      {label:'Put OI',data:[9876,8765,7654,6543,5432]}
    ]},options:{responsive:true,maintainAspectRatio:false}});
    new Chart(volCtx,{type:'line',data:{labels,datasets:[
      {label:'Call Vol',data:[4567,5432,6789,7654,8765],fill:true,tension:.35},
      {label:'Put Vol',data:[3456,4123,5432,6789,7654],fill:true,tension:.35}
    ]},options:{responsive:true,maintainAspectRatio:false}});
    new Chart(payoffCtx,{type:'line',data:{labels:['42,8','43,2','43,6','44,0','44,4'],datasets:[{label:'P&L',data:[-3800,-3800,6200,6200,-3800],fill:true,tension:.2}]} ,options:{responsive:true,maintainAspectRatio:false}});
    new Chart(callOiCtx,{type:'bar',data:{labels:labels.slice(1),datasets:[{label:'CE OI',data:[82000,78000,69000,63000]}]},options:{responsive:true,maintainAspectRatio:false}});
    new Chart(putOiCtx,{type:'bar',data:{labels:labels.slice(0,4),datasets:[{label:'PE OI',data:[67890,61200,58000,54000]}]},options:{responsive:true,maintainAspectRatio:false}});
    new Chart(thetaCtx,{type:'line',data:{labels:['D-7','D-6','D-5','D-4','D-3','D-2','D-1'],datasets:[{label:'Theta',data:[-120,-140,-170,-210,-260,-340,-480],fill:true,tension:.3}]} ,options:{responsive:true,maintainAspectRatio:false}});
    new Chart(ivTermCtx,{type:'line',data:{labels:['1w','2w','1m','2m','3m'],datasets:[{label:'IV %',data:[18,19,20,19,18],fill:false,tension:.3}]},options:{responsive:true,maintainAspectRatio:false}});
    new Chart(perfCtx,{type:'line',data:{labels:['Mar','Apr','May','Jun','Jul','Aug'],datasets:[
      {label:'AI',data:[0,2.1,4.8,7.2,10.9,14.2],fill:true,tension:.35},
      {label:'Benchmark',data:[0,1.4,2.7,3.9,5.2,6.1],fill:true,tension:.35}
    ]},options:{responsive:true,maintainAspectRatio:false}});

    // Hooks (wire to your API later)
    document.getElementById('fetchBtn').addEventListener('click', ()=>{
      // TODO: call /optionchain & friends, then hydrate charts + table
      const btn = document.getElementById('fetchBtn');
      btn.disabled = true; btn.innerHTML = '<span class="spinner-border spinner-border-sm me-1"></span>Fetching...';
      setTimeout(()=>{btn.disabled=false; btn.innerHTML='<i class="bi bi-lightning-charge me-1"></i>Fetch Option Chain'},1200);
    });
  </script>
</body>
</html>
